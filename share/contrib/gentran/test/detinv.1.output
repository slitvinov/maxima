      subroutine detinv(m,det,inv)
<<    on(gendecs)$    >>


      t0=m(1,3)*(-m(2,2)*m(3,1)+m(2,1)*m(3,2))
      t0=t0-m(1,2)*(-m(2,3)*m(3,1)+m(2,1)*m(3,3))
      det=t0+m(1,1)*(-m(2,3)*m(3,2)+m(2,2)*m(3,3))

      t1=-m(2,3)*m(3,2)+m(2,2)*m(3,3)
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(1,1)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))
      t1=-(-m(1,3)*m(3,2)+m(1,2)*m(3,3))
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(1,2)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))
      t1=-m(1,3)*m(2,2)+m(1,2)*m(2,3)
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(1,3)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))
      t1=-(-m(2,3)*m(3,1)+m(2,1)*m(3,3))
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(2,1)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))
      t1=-m(1,3)*m(3,1)+m(1,1)*m(3,3)
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(2,2)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))
      t1=-(-m(1,3)*m(2,1)+m(1,1)*m(2,3))
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(2,3)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))
      t1=-m(2,2)*m(3,1)+m(2,1)*m(3,2)
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(3,1)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))
      t1=-(-m(1,2)*m(3,1)+m(1,1)*m(3,2))
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(3,2)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))
      t1=-m(1,2)*m(2,1)+m(1,1)*m(2,2)
      t0=(-m(1,3)*m(2,2)+m(1,2)*m(2,3))*m(3,1)
      t0=t0+(m(1,3)*m(2,1)-m(1,1)*m(2,3))*m(3,2)
      inv(3,3)=t1/(t0+(-m(1,2)*m(2,1)+m(1,1)*m(2,2))*m(3,3))

return
end
